{% spaceless %}
    {# This file might seem a little complex, because of the high density of tags.
       It uses Twig macros and ternary selectors. Read up on them, if required:
       macros: http://twig.sensiolabs.org/doc/templates.html#macros
       ternary operators: http://twig.sensiolabs.org/doc/templates.html#other-operators
    #}

    {# The 'recursive' macro, for inserting one menu item. If it has a submenu, it
       invokes itself to insert the items of the submenus. #}
    {% macro display_menu_item(item, loop) %}
        {% from _self import display_menu_item %}
        {% spaceless %}
            <li class="
                {{ item.path|default('') == 'homepage' ? '' -}}
                {{ ' ' ~ item.class|default('') -}}">

                <a href="{{ item.link }}"
                   title='{{ item.title|default('')|escape }}'
                   class='{{ item|current ? ' active' }}'>
                    <span>{{- item.label|default('-') -}}</span>
                </a>

            </li>
        {% endspaceless %}
    {% endmacro %}

    {# Make the macro available for use #}
    {% from _self import display_menu_item %}

    <!-- start subnav -->
    <nav class="toplayer">
        <ul class="toplayer-menu">
            {% for item in menu %}
                {% if item.label is defined %}
                    {{ display_menu_item(item, loop) }}
                {% endif %}
            {% endfor %}
        </ul>
    </nav>
    <!-- end subnav-->

{% endspaceless %}

