{#
Avaliable variables
    'module': the full module object
    'title': title of the module
    'body': body of the module
    'records': array of (selected) records that belong to the module
#}
{% if title is not empty or body is not empty %}
    {% if title is not empty %}
        <h2>{{ title }}</h2>
    {% endif %}
    {{ body|raw }}
{% endif %}

{% if records is iterable %}
    {% set template = module.get('templates') %}
    {% for record in records %}
        {% if record.id is defined %}
            {% set templatefile =  'views/_' ~  template ~ '_' ~ record.contenttype.slug ~ '.twig' %}
            {% set defaulttemplatefile =  'views/_' ~  template ~ '.twig' %}
            <!-- loading templatefile for record: '{{ templatefile }}' or '{{ defaulttemplatefile }}' or 'views/_fallback.twig' -->
            {% include [templatefile, defaulttemplatefile, 'views/_fallback.twig'] with { record: record } %}
        {% else %}
            <!-- selected record is unpublished or otherwise unavailable -->
        {% endif %}
    {% endfor %}
{% endif %}
