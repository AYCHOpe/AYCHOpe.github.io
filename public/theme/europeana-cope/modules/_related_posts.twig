{% spaceless %}
{% set template = 'related' %}
{% endspaceless %}

<section class="related-content">
    <h2>{{ title|default('Related content') }}</h2>

    <div class="teaser-container">

    {% set records = record.related()|shuffle|slice(0, 3) %}

    {% if records is iterable %}
        {% for record in records %}
            {% if record.id is defined %}
                {% set templatefile =  'views/_' ~  template ~ '_' ~ record.contenttype.slug ~ '.twig' %}
                {% set defaulttemplatefile =  'views/_' ~  template ~ '.twig' %}
                <!-- loading templatefile for record: '{{ templatefile }}' or '{{ defaulttemplatefile }}' or 'views/_fallback.twig' -->
                {% include [templatefile, defaulttemplatefile, 'views/_fallback.twig'] with { item: record, template: template } %}
            {% else %}
                <!-- selected record is unpublished or otherwise unavailable -->
            {% endif %}
        {% endfor %}
    {% endif %}

    </div>
</section>


