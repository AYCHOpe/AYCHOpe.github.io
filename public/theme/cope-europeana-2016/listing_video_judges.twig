{#
Patternlab links:
http://develop.styleguide.eanadev.org/?p=templates-HIM-video-list
http://develop.styleguide.eanadev.org/?p=templates-HIM-video-judge
#}
{% extends '_base_page.twig' %}

{% block bodyclass %}page_entry_list{% endblock %}

{% block main %}
{% if is_member() and is_judge %}
<!-- Start content -->
<div class="l-content">

    <div class="page_header">
        {% include 'items/_item-breadcrumb.twig' %}
    </div>

    <div class="user-banner-inline">
        Hello {{ member.displayname }}. You can rate the entries below.
    </div>


    {% if record is defined %}
        <!-- We have a record -->
        {#{{ dump(record) }}#}
        {% setcontent records = 'himentries' where { 'stages': 'in_review', 'status': '!' } allowpaging %}
        <div class="textcontent">
            <div class="prose">
                <h1 class="title">{{ record.title }}</h1>
                <p class="intro">{{ record.intro }}</p>
            </div>
        </div>
    {% elseif records is not defined %}
        <!-- We have nothing -->
        {% set records = [] %}
    {% endif %}
    {#{{ dump(himentries|default('')) }}#}

    <div class="video-list section">
        <ul class="cf">
            {% for item in records %}
                <li class="video-list-item">
                    {% include('items/_item-intro-video-judge.twig') with { item: item } %}
                </li>
            {% else %}
                <li class="video-list-item">
                    <p>No entries found.</p>
                </li>
            {% endfor %}
        </ul>
        {{ pager() }}
    </div>

    {% if record is defined %}
    <div class="textcontent">
        <div class="prose">
            <div class="prose">{{ record.body }}</div>
        </div>
    </div>
    {% endif %}

</div>

<div class="l-sidebar">
    {%  include 'items/_item-profile-mini.twig' with { currentuser: currentuser, member: member|default(), member_meta: member_meta|default() } %}
    
    {% include 'items/_item-tags-large.twig' with {items:null} %}

    {% if record is defined %}
        {% set contacts = record.related('persons') %}
        {% if contacts is defined %}
            {% include 'items/_item-help.twig' with { records: contacts } %}
        {% endif %}
    {% else %}
        <!-- no contact for sidebar found -->
    {% endif %}


</div>


<!-- End Content -->
{% else %}
    <div class="l-content">
        <div class="page_header">
            {% include 'items/_item-breadcrumb.twig' %}
        </div>

        <div id="entry-detail" class="entry-detail">
            <p>You need to <a href="/authentication/login">sign in</a> for this.</p>
        </div>
    </div>
    <div class="l-sidebar">
    </div>
{% endif %}


{% endblock %}
